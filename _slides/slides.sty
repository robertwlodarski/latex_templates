% ==============================================================================
% Table of contents
% ==============================================================================
% 1. Latex programming tools
% 2. Color initialization
% 3. Fonts and typography
% 4. Beamer options and layout
% 5. Title page customization
% 6. Table of contents settings
% 7. Lists and bullet points
% 8. Bibliography and references
% 9. Math fixes
% 10. Hyperlinks
% 11. Color palettes and text highlighting
% 12. Math packages and tikz setup
% 13. Blocks and boxes
% 14. Code listings
% 15. Layout helpers
% 16. Tables and tabular environments
% 17. Figures and images
% 18. Transition slides
% 19. Custom coordinate systems
% ==============================================================================


% ------------------------------------------------------------------------------
% 1. Latex programming tools
% ------------------------------------------------------------------------------
% \AtBeginEnvironment
% https://tex.stackexchange.com/questions/33576/conditional-typesetting-build
\usepackage{etoolbox}
\usepackage{xparse}

% Remove annoying over-full box warnings
\vfuzz=2pt 
\hfuzz=2pt


% ------------------------------------------------------------------------------
% 2. Color initialization
% ------------------------------------------------------------------------------
\usepackage{xcolor}

% Define `accent`/`accent2` colors for theme customization
% User preference: Maroon accents
\definecolor{accent}{RGB}{128, 0, 0}      % Maroon
\definecolor{accent2}{RGB}{194, 102, 127} % Light maroon

% ------------------------------------------------------------------------------
% 3. Fonts and typography
% ------------------------------------------------------------------------------
% Beamer Option to use custom fonts
\usefonttheme{professionalfonts}
% T1 removes errors for things like \textbackslash
\usepackage[T1]{fontenc}
\usepackage{inputenc}

% Serif option:
% libertine for serif text font
% cochineal for classier setif text font 
 \usepackage{libertine}
%  Source Code Pro for monospace font
 \usepackage[scale=0.88]{plex-mono}
 \renewcommand{\ttdefault}{\plexmonofamily}

% Small adjustments to text kerning
\usepackage{microtype}


% ------------------------------------------------------------------------------
% 4. Beamer options and layout
% ------------------------------------------------------------------------------
% Background
\setbeamercolor{background canvas}{bg = white}

% Change text margins
\setbeamersize{text margin left = 10pt, text margin right = 10pt}  

% \alert
\setbeamercolor{alerted text}{fg = accent}

% Frame title
\setbeamercolor{frametitle}{bg = white, fg = zinc900}
\setbeamerfont{frametitle}{series = \bfseries}  
\setbeamercolor{framesubtitle}{bg = white, fg = accent}
\setbeamerfont{framesubtitle}{size = \small, series = \bfseries}
%\setbeamerfont{framesubtitle}{size = \small, shape = \itshape}

% Page numbering
\setbeamercolor{page number in head/foot}{fg=zinc600}
\setbeamerfont{footline}{size=\scriptsize, family=\ttfamily}
\defbeamertemplate{footline}{frame number spacing}{
  \hfill%
  \usebeamercolor[fg]{page number in head/foot}%
  \usebeamerfont{page number in head/foot}%
  \strut\usebeamertemplate*{page number in head/foot}\kern0.6em\vskip1.4pt%
}
[action]
{
  \setbeamertemplate{page number in head/foot}[totalframenumber]%
}
\setbeamertemplate{footline}[frame number spacing]{}

% Appendix numbering
\usepackage{appendixnumberbeamer}
\renewcommand\appendixname{Appendix}

% Button 
\setbeamercolor{button}{bg = white, fg = zinc600!80!accent}
\setbeamerfont{button}{family = \ttfamily}
\setbeamercolor{button border}{fg = black}

% Let's you put \beamerbutton in bottom right corner
\usepackage[absolute,overlay]{textpos}
\newcommand\bottomleft[1]{%
  \begin{textblock*}{\paperwidth}(0pt,{\dimexpr\textheight + 2.5pt})
    \hspace{8pt}\raggedright #1
  \end{textblock*}
}
\newcommand\bottomright[1]{%
  \begin{textblock*}{\paperwidth}(0pt,\textheight)
    \raggedleft #1\hspace{8pt}
  \end{textblock*}
}

% Remove navigation symbols
\setbeamertemplate{navigation symbols}{}

% Table and Figure captions
\setbeamercolor{caption}{fg = zinc900!70!white}
\setbeamercolor{caption name}{fg=zinc900}
\setbeamerfont{caption name}{shape = \itshape}

% Line spacing
\usepackage{setspace}
\setstretch{1}

% Chance spacing around equations
\AtBeginDocument{\setlength\abovedisplayskip{\medskipamount}}
\AtBeginDocument{\setlength\belowdisplayskip{\bigskipamount}}
\AtBeginDocument{\setlength\abovedisplayshortskip{\medskipamount}}
\AtBeginDocument{\setlength\belowdisplayshortskip{\bigskipamount}}


% ------------------------------------------------------------------------------
% 5. Title page customization
% ------------------------------------------------------------------------------
\setbeamercolor{title}{fg = zinc900}
\setbeamercolor{subtitle}{fg = accent}

% \today => Month Year
\renewcommand{\today}{\ifcase \month \or January\or February\or March\or April\or May \or June\or July\or August\or September\or October\or November\or December\fi\ \number \year}

%% Custom \maketitle and \titlepage
\setbeamertemplate{title page}
{
  %\begin{centering}
  \vspace{20mm}
  \centering
  {\Large \bfseries \usebeamerfont{title}\usebeamercolor[fg]{title}\inserttitle}\\ \vskip0.25em%
  \ifx\insertsubtitle\@empty%
  \else%
    {\usebeamerfont{subtitle}\usebeamercolor[fg]{subtitle}\insertsubtitle\par}%
  \fi% 
  {\vspace{10mm}\insertauthor}\\
  {\vspace{10mm}\color{zinc500}\small{\today}}\\
  %\end{centering}
}


% ------------------------------------------------------------------------------
% 6. Table of contents settings
% ------------------------------------------------------------------------------
\setbeamerfont{section in toc}{size = \large, series = \bfseries}
\setbeamerfont{section in toc shaded}{size = \large}
\setbeamercolor{section in toc}{fg = zinc800}
\setbeamertemplate{section in toc shaded}[default][60] % opacity
\AtBeginSection[]{
  {
    \hypersetup{hidelinks}
    \begin{frame}[noframenumbering,plain]{\ }
      \tableofcontents[currentsection]
    \end{frame}
  }
}


% ------------------------------------------------------------------------------
% 7. Lists and bullet points
% ------------------------------------------------------------------------------
%% Fix left-margins
\settowidth{\leftmargini}{\usebeamertemplate{itemize item}}
\addtolength{\leftmargini}{\labelsep}

%% enumerate item color
\setbeamercolor{enumerate item}{fg = black, bg = zinc300}
\setbeamerfont{enumerate item}{size = \small}
\setbeamertemplate{enumerate item}[square]
\setbeamertemplate{enumerate items}{%
  \usebeamercolor[bg]{enumerate item}%
  \raisebox{0.25ex}{%
  \makebox[0.25em]{
    \colorbox{zinc300}{%
      \makebox[1.15ex][c]{\color{black}\insertenumlabel }%
    }%
  }%
  }
  %\kern 0.25em
}
\setbeamercolor{enumerate subitem}{fg=zinc300}
\setbeamertemplate{enumerate subitem}{(\roman{enumii})}

%\setbeamercolor{enumerate item}{fg = zinc600}
%\setbeamerfont{enumerate item}{size = \small}
%\setbeamertemplate{enumerate item}{\insertenumlabel.}

%% enumerate subitems and subsubitems
\setbeamercolor{enumerate subitem}{fg = zinc600}
\setbeamercolor{enumerate subsubitem}{fg = zinc600}

%% itemize item
\setbeamercolor{itemize item}{fg = zinc600}
\setbeamerfont{itemize item}{size = \small}
\setbeamertemplate{itemize item}[square]

%% square for subitems
\setbeamercolor{itemize subitem}{fg = zinc600}
\setbeamerfont{itemize subitem}{size = \small}
\setbeamertemplate{itemize subitem}[square]

%% square for subsubitems
\setbeamercolor{itemize subsubitem}{fg = zinc600}
\setbeamerfont{itemize subsubitem}{size = \footnotesize}
\setbeamertemplate{itemize subsubitem}[triangle]

% arrow items 
\newenvironment{itemize_arrow}{%
  \begin{itemize}
  \setbeamertemplate{itemize item}{\textcolor{zinc600}{$\rightarrow$}}
  \setbeamertemplate{itemize subitem}{\textcolor{zinc600}{$\rightarrow$}}
  \setbeamertemplate{itemize subsubitem}{\textcolor{zinc600}{$\rightarrow$}}
}{%
  \end{itemize}
}


% ------------------------------------------------------------------------------
% 8. Bibliography and references
% ------------------------------------------------------------------------------
% biblatex 
\usepackage[
  natbib = true, 
  backend = biber,
  citestyle= authoryear,
  style = ext-authoryear-ecomp,
  url = false,
]{biblatex}

% Smaller font-size for references
\renewcommand*{\bibfont}{\small}

% % Remove "In:"
\renewbibmacro{in:}{}

% Color citations for slides \citecolor{}
\newcommand{\citecolor}[1]{%
  {\footnotesize\begin{color}{zinc500}%
    #1%
  \end{color}}%
}

% Bibliography Font, roughly matching AEA
\setbeamertemplate{bibliography item}{}

\setbeamerfont{bibliography entry author}{size = \footnotesize, series = \bfseries}
\setbeamercolor{bibliography entry author}{fg = zinc900}

\setbeamerfont{bibliography entry title}{size = \footnotesize, series = \mdseries}
\setbeamercolor{bibliography entry title}{fg = zinc900}

\setbeamerfont{bibliography entry location}{size = \footnotesize, shape = \itshape, series = \mdseries}
\setbeamercolor{bibliography entry location}{fg = zinc900}

\setbeamerfont{bibliography entry note}{size = \footnotesize, series = \mdseries}
\setbeamercolor{bibliography entry note}{fg = zinc900}


% ------------------------------------------------------------------------------
% 9. Math fixes
% ------------------------------------------------------------------------------
% Pause in align fix 
% https://tex.stackexchange.com/a/75550/334034
\makeatletter
\let\save@measuring@true\measuring@true
\def\measuring@true{%
  \save@measuring@true
  % might not be necessary and might have unwarranted side effects
  \def\beamer@sortzero##1{\beamer@ifnextcharospec{\beamer@sortzeroread{##1}}{}}%
  \def\beamer@sortzeroread##1<##2>{}%
  \def\beamer@finalnospec{}%
}
\makeatother


% ------------------------------------------------------------------------------
% 10. Hyperlinks
% ------------------------------------------------------------------------------
\usepackage{hyperref}
\hypersetup{
  colorlinks = true,
  linkcolor = accent,
  filecolor = accent2,
  urlcolor = accent2,
  citecolor = accent2,
}


% ------------------------------------------------------------------------------
% 11. Color palettes and text highlighting
% ------------------------------------------------------------------------------

% 1. Zinc (Grays) from Tailwind Colors
\definecolor{zinc50}{HTML}{fafafa}
\definecolor{zinc100}{HTML}{f4f4f5}
\definecolor{zinc200}{HTML}{e4e4e7}
\definecolor{zinc300}{HTML}{d4d4d8}
\definecolor{zinc400}{HTML}{a1a1aa}
\definecolor{zinc500}{HTML}{71717a}
\definecolor{zinc600}{HTML}{52525b}
\definecolor{zinc700}{HTML}{3f3f46}
\definecolor{zinc800}{HTML}{27272a}
\definecolor{zinc900}{HTML}{18181b}
\definecolor{zinc950}{HTML}{09090b}

% 2. Primary Theme Colors (Maroon)
% Defining 'maroon' explicitly so it can be called by name
\definecolor{maroon}{RGB}{128, 0, 0}       % Deep Maroon
\definecolor{maroonLight}{RGB}{194, 102, 127} % Light Maroon

% Map standard theme accents to Maroon
\colorlet{accent}{maroon}
\colorlet{accent2}{maroonLight}

% 3. Supplementary Palette (Toronto Style)
% Deep Navy: Used for text headers to contrast with Maroon
\definecolor{presNavy}{HTML}{002F5F} 
% Gold: Used for ideas/implementation (complementary to Maroon)
\definecolor{presGold}{HTML}{B8860B}

% 4. Background Colors (Pastels for text boxes)
\definecolor{bgMaroon}{RGB}{242, 230, 230} % Very pale maroon
\definecolor{bgNavy}{HTML}{D1E5F0}         % Pale navy
\definecolor{bgGold}{HTML}{FDF2D0}         % Pale gold

% 5. Modern Highlighting Tools (Bold + Color)
% Usage: \maroon{Important Text}, \navy{Header Text}
\newcommand\maroon[1]{{\color{maroon}\textbf{#1}}}
\newcommand\lightMaroon[1]{{\color{maroonLight}\textbf{#1}}}
\newcommand\navy[1]{{\color{presNavy}\textbf{#1}}}
\newcommand\gold[1]{{\color{presGold}\textbf{#1}}}

% Usage: \bgMaroon{Text inside box}
\newcommand\bgMaroon[1]{\colorbox{bgMaroon}{#1}}
\newcommand\bgNavy[1]{\colorbox{bgNavy}{#1}}
\newcommand\bgGold[1]{\colorbox{bgGold}{#1}}

% 6. Legacy / Dependency Colors (Kept for compatibility)
% Definitions
\definecolor{oldNavy}{HTML}{002C55}
\definecolor{raspberry}{HTML}{940034}
\definecolor{cranberry}{HTML}{B3114B}
\definecolor{orange}{HTML}{D65616}
\definecolor{purple}{HTML}{5C4CBF}
\definecolor{blue}{HTML}{0188AC}
\definecolor{green}{HTML}{2DB25F}
\definecolor{rose}{HTML}{FB7185}
\definecolor{yellow}{HTML}{ffc517}

% Backgrounds
\definecolor{bgRaspberry}{HTML}{ff96a9}
\definecolor{bgCranberry}{HTML}{fda4d0}
\definecolor{bgOrange}{HTML}{f6b97b}
\definecolor{bgPurple}{HTML}{adb4f4}
\definecolor{bgBlue}{HTML}{cdfbff}
\definecolor{bgGreen}{HTML}{8ee7af}
\definecolor{bgRose}{HTML}{fecdd4}
\definecolor{bgYellow}{HTML}{ffea88}

% Commands
\newcommand\oldNavy[1]{{\color{oldNavy}#1}}
\newcommand\raspberry[1]{{\color{raspberry}#1}}
\newcommand\cranberry[1]{{\color{cranberry}#1}}
\newcommand\orange[1]{{\color{orange}#1}}
\newcommand\purple[1]{{\color{purple}#1}}
\newcommand\blue[1]{{\color{blue}#1}}
\newcommand\green[1]{{\color{green}#1}}
\newcommand\rose[1]{{\color{rose}#1}}
\newcommand\yellow[1]{{\color{yellow}#1}}

\newcommand\bgRaspberry[1]{\colorbox{bgRaspberry}{#1}}
\newcommand\bgCranberry[1]{\colorbox{bgCranberry}{#1}}
\newcommand\bgOrange[1]{\colorbox{bgOrange}{#1}}
\newcommand\bgPurple[1]{\colorbox{bgPurple}{#1}}
\newcommand\bgBlue[1]{\colorbox{bgBlue}{#1}}
\newcommand\bgGreen[1]{\colorbox{bgGreen}{#1}}
\newcommand\bgRose[1]{\colorbox{bgRose}{#1}}
\newcommand\bgYellow[1]{\colorbox{bgYellow}{#1}}


% ------------------------------------------------------------------------------
% 12. Math packages and tikz setup
% ------------------------------------------------------------------------------
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{graphicx}
\usepackage{bm}

% Load tcolorbox and tikz 
\usepackage[beamer,customcolors]{hf-tikz}
\usetikzlibrary{calc, fit, shapes.misc, shadows, arrows.meta}
\usepackage[most,skins]{tcolorbox}
\tcbuselibrary{breakable}
\tcbset{
  highlight math/.style={
    notitle, enhanced, 
    on line, boxsep=2pt, left=0pt, right=0pt, top=0pt, bottom=0pt,
    colback = bgRaspberry, colframe = white,
  }
}


% ------------------------------------------------------------------------------
% 13. Blocks and boxes
% ------------------------------------------------------------------------------

% 1. Default Block Style (Mapped to Zinc)
% This applies when you just use \begin{block}{Title} ... \end{block}
\defbeamertemplate{block begin}{framed}[1][] {
  \begin{tcolorbox}[colback=zinc50, colframe=zinc200, arc=0mm]
  {
    %\vskip\smallskipamount%
    \ifthenelse{\equal{\insertblocktitle}{-}}{}{%
      \raggedright\usebeamerfont*{block title}\usebeamercolor[fg]{title}%
      \textbf{\insertblocktitle}%
      \vskip\medskipamount%
    }
  }%
  \raggedright%
  \usebeamerfont{block body}%
}
\defbeamertemplate{block end}{framed}[1][] {
  \vskip\smallskipamount\end{tcolorbox}
}
\setbeamertemplate{blocks}[framed]

% 2. Zinc Block (Explicit)
\newenvironment*{zincBlock}[1]{%
  \begin{tcolorbox}[colback=zinc50, colframe=zinc200, arc=0mm]{
    \vskip\smallskipamount%
    \ifthenelse{\equal{#1}{}}{}{%
      \raggedright\usebeamerfont*{block title}\usebeamercolor[fg]{title}%
      \textbf{#1}%
      \vskip\medskipamount%
    }%
  }%
  \raggedright%
  \usebeamerfont{block body}%
}{%
  \vskip\smallskipamount\end{tcolorbox}
}

% 3. Maroon Block
% Uses bgMaroon for background and accent2 (Light Maroon) for border
\newenvironment*{maroonBlock}[1]{%
  \begin{tcolorbox}[colback=bgMaroon, colframe=accent2, arc=0mm]{
    \vskip\smallskipamount%
    \ifthenelse{\equal{#1}{}}{}{%
      \raggedright\usebeamerfont*{block title}\usebeamercolor[fg]{title}%
      \maroon{#1}%
      \vskip\medskipamount%
    }%
  }%
  \raggedright%
  \usebeamerfont{block body}%
}{%
  \vskip\smallskipamount\end{tcolorbox}
}

% 4. Navy Block
% Uses bgNavy for background and a 40% opacity Navy for border
\newenvironment*{navyBlock}[1]{%
  \begin{tcolorbox}[colback=bgNavy, colframe=presNavy!40!white, arc=0mm]{
    %\vskip\smallskipamount%
    \ifthenelse{\equal{#1}{}}{}{%
      \raggedright\usebeamerfont*{block title}\usebeamercolor[fg]{title}%
      \navy{#1}%
      \vskip\medskipamount%
    }%
  }%
  \raggedright%
  \usebeamerfont{block body}%
}{%
  \vskip\smallskipamount\end{tcolorbox}
}

% 5. Gold Block
% Uses bgGold for background and a 50% opacity Gold for border
\newenvironment*{goldBlock}[1]{%
  \begin{tcolorbox}[colback=bgGold, colframe=presGold!50!white, arc=0mm]{
    \vskip\smallskipamount%
    \ifthenelse{\equal{#1}{}}{}{%
      \raggedright\usebeamerfont*{block title}\usebeamercolor[fg]{title}%
      \gold{#1}%
      \vskip\medskipamount%
    }%
  }%
  \raggedright%
  \usebeamerfont{block body}%
}{%
  \vskip\smallskipamount\end{tcolorbox}
}

% ------------------------------------------------------------------------------
% 14. Code listings
% ------------------------------------------------------------------------------
\usepackage{listings}
\tcbuselibrary{listings,listingsutf8,skins}
\tcbset{
  codelanguage/.style={language = #1},
  codelanguage/.default = R,
}
\DeclareTCBListing{codeblock}{ !O{R} }{
  listing only,
  interior hidden,
  top = -6pt, 
  bottom = -6pt,
  left = 4pt, 
  right = 0pt,
  boxrule = 0pt, 
  frame hidden, 
  sharp corners, 
  borderline west = {2pt}{0pt}{zinc400}, 
  enhanced,
  breakable,
  listing options={
    basicstyle = \small\ttfamily,
    columns = fixed,
    keepspaces = true,
    language = #1
  }
}


% ------------------------------------------------------------------------------
% 15. Layout helpers
% ------------------------------------------------------------------------------
% \begin{columns} 
\usepackage{multicol}


% ------------------------------------------------------------------------------
% 16. Tables and tabular environments
% ------------------------------------------------------------------------------
% Fix \input with tables
% \input fails when \\ is at end of external .tex file
\makeatletter
\let\input\@@input
\makeatother

% Slighty more spacing between rows
\usepackage{array}
\renewcommand\arraystretch{1}

% Scale table proportionally to a width
% \begin{adjustbox}{width=\textwidth, center}
%   ...
% \end{adjustbox}
\usepackage{adjustbox}

% \toprule, \cmidrule, \bottomrule
\usepackage{booktabs}

% Tables too narrow
% \begin{tabularx}{\linewidth}{cols}
% col-types: X - center, L - left, R -right
% Relative scale: >{\hsize=.8\hsize}X/L/R
\usepackage{tabularx}
\newcolumntype{L}{>{\raggedright\arraybackslash}X}
\newcolumntype{R}{>{\raggedleft\arraybackslash}X}
\newcolumntype{C}{>{\centering\arraybackslash}X}

% Table notes with \note{...} or \note[Source:]{...} command
\RenewDocumentCommand{\note}{O{Notes.} m g}{%
  \IfNoValueTF{#3}{%
    \footnotesize\vspace*{\medskipamount}%
    \noindent\emph{#1} #2
  }{%  
    \parbox{#2}{\footnotesize\vspace*{\medskipamount}%
      \noindent\emph{#1} #3
    }%
  }
}

% Since we don't use `table` environments in slides
\NewDocumentCommand{\tabletitle}{O{Outcome:} m}{%
  {\footnotesize\textsc{#1} #2 \\[\medskipamount]}
}

% Table Highlighting 

% Create top-left and bottom-right markets in tabular cells with a unique matching id and these commands will outline those cells
\usepackage[beamer,customcolors]{hf-tikz}
\usetikzlibrary{calc}
\usetikzlibrary{fit,shapes.misc}

% To set the hypothesis highlighting boxes red.
\newcommand\marktopleft[1]{%
  \tikz[overlay,remember picture] 
      \node (marker-#1-a) at (0,1.5ex) {};%
}
\newcommand\markbottomright[1]{%
  \tikz[overlay,remember picture] 
    \node (marker-#1-b) at (0,0) {};%
  \tikz[accent!80!zinc900, ultra thick, overlay, remember picture, inner sep=4pt]
    \node[draw, rectangle, fit=(marker-#1-a.center) (marker-#1-b.center)] {};%
}

% \cellcolor<#>{color}
\renewcommand<>\cellcolor[1]{\only#2{\beameroriginal\cellcolor{#1}}}

% https://tex.stackexchange.com/questions/18427/why-cant-i-wrap-rowcolor-in-only-beamer
% Redefine `\rowcolor` to allow a beamer overlay specifier
% New syntax: \rowcolor<overlay>[color model]{color}[left overhang][right overhang]
\makeatletter
% Open `\noalign` and check for overlay specification:
\def\rowcolor{\noalign{\ifnum0=`}\fi\bmr@rowcolor}
\newcommand<>{\bmr@rowcolor}{%
    \alt#1%
        {\global\let\CT@do@color\CT@@do@color\@ifnextchar[\CT@rowa\CT@rowb}% Rest of original `\rowcolor`
        {\ifnum0=`{\fi}\@gooble@rowcolor}% End `\noalign` and gobble all arguments of `\rowcolor`.
}
% Gobble all normal arguments of `\rowcolor`:
\newcommand{\@gooble@rowcolor}[2][]{\@gooble@rowcolor@}
\newcommand{\@gooble@rowcolor@}[1][]{\@gooble@rowcolor@@}
\newcommand{\@gooble@rowcolor@@}[1][]{\ignorespaces}
\makeatother

% Test
\usepackage{dcolumn}
\newcolumntype{d}[0]{D{.}{.}{-1}}


% ------------------------------------------------------------------------------
% 17. Figures and images
% ------------------------------------------------------------------------------
% \imageframe{img_name}
% from https://github.com/mattzinc900well/cousteau
\newcommand{\imageframe}[1]{%
    \begin{frame}[plain]
        \begin{tikzpicture}[remember picture, overlay]
            \node[at = (current page.center), xshift = 0cm] (cover) {%
                \includegraphics[keepaspectratio, width=\paperwidth, height=\paperheight]{#1}
            };
        \end{tikzpicture}
    \end{frame}%
}

% subfigures
\usepackage{subfigure}


% ------------------------------------------------------------------------------
% 18. Transition slides
% ------------------------------------------------------------------------------
% \begin{transitionframe} Text \end{transitionframe}
% from paulgp's beamer tips
\newenvironment{transitionframe}{
    \setbeamercolor{background canvas}{bg=accent!60!black}
    \begin{frame}[noframenumbering,plain,c]\color{white}\LARGE\centering
}{
    \end{frame}
}


% ------------------------------------------------------------------------------
% 19. Custom coordinate systems
% ------------------------------------------------------------------------------
% Define custom slide coordinate system 
% https://tex.stackexchange.com/questions/89588/positioning-relative-to-page-in-tikz
% Defining a new coordinate system for the page:
%
% ┌──────────────────────────────────────────────┐
% │ (0, 0)                                (1, 0) │
% │                                              │
% │                                              │
% │                                              │
% │                                              │
% │                                              │
% │ (0, 1)                                (1, 1) │
% └──────────────────────────────────────────────┘
% 
% source: https://tex.stackexchange.com/questions/89588/positioning-relative-to-page-in-tikz
% 
\makeatletter
\def\parsecomma#1,#2\endparsecomma{\def\page@x{#1}\def\page@y{#2}}
\tikzdeclarecoordinatesystem{page}{
    \parsecomma#1\endparsecomma
    \pgfpointanchor{current page}{north west}
    % Save the upper left corner
    \pgf@xa=\pgf@x%
    \pgf@ya=\pgf@y%
    % save the lower right corner
    \pgfpointanchor{current page}{south east}
    \pgf@xb=\pgf@x%
    \pgf@yb=\pgf@y%
    % Transform to the correct placement
    \pgfmathparse{(\pgf@xb-\pgf@xa)*\page@x+\pgf@xa}
    \expandafter\pgf@x\expandafter=\pgfmathresult pt
    \pgfmathparse{(\pgf@yb-\pgf@ya)*\page@y+\pgf@ya}
    \expandafter\pgf@y\expandafter=\pgfmathresult pt
}
\makeatother

% To overlay on beamer slides, use the following:
% 
% \begin{tikzpicture}[remember picture, overlay]
%   \node[anchor = north west] (anchor_name) at (page cs:0.0, 0.0) {    
%     CONTENT HERE  
%   };
% \end{tikzpicture}
% 
% Note page cs is the coordinate system from above

% To help with placement, I will use `\devgrid` on a slide to figure out the coordinates of `page cs` to the 0.1
\newcommand{\devgrid}{
  \begin{tikzpicture}[remember picture, overlay]
    % vertical lines
    \draw (page cs: 0.1, 0.0) edge[black!20!white, line width = 0.3mm, dotted] (page cs: 0.1, 1.0);
    \draw (page cs: 0.2, 0.0) edge[black!20!white, line width = 0.3mm, dotted] (page cs: 0.2, 1.0);
    \draw (page cs: 0.3, 0.0) edge[black!20!white, line width = 0.3mm, dotted] (page cs: 0.3, 1.0);
    \draw (page cs: 0.4, 0.0) edge[black!20!white, line width = 0.3mm, dotted] (page cs: 0.4, 1.0);
    \draw (page cs: 0.5, 0.0) edge[black!20!white, line width = 0.3mm, dotted] (page cs: 0.5, 1.0);
    \draw (page cs: 0.6, 0.0) edge[black!20!white, line width = 0.3mm, dotted] (page cs: 0.6, 1.0);
    \draw (page cs: 0.7, 0.0) edge[black!20!white, line width = 0.3mm, dotted] (page cs: 0.7, 1.0);
    \draw (page cs: 0.8, 0.0) edge[black!20!white, line width = 0.3mm, dotted] (page cs: 0.8, 1.0);
    \draw (page cs: 0.9, 0.0) edge[black!20!white, line width = 0.3mm, dotted] (page cs: 0.9, 1.0);

    % horizontal lines
    \draw (page cs: 0.0, 0.1) edge[black!20!white, line width = 0.3mm, dotted] (page cs: 1.0, 0.1);
    \draw (page cs: 0.0, 0.2) edge[black!20!white, line width = 0.3mm, dotted] (page cs: 1.0, 0.2);
    \draw (page cs: 0.0, 0.3) edge[black!20!white, line width = 0.3mm, dotted] (page cs: 1.0, 0.3);
    \draw (page cs: 0.0, 0.4) edge[black!20!white, line width = 0.3mm, dotted] (page cs: 1.0, 0.4);
    \draw (page cs: 0.0, 0.5) edge[black!20!white, line width = 0.3mm, dotted] (page cs: 1.0, 0.5);
    \draw (page cs: 0.0, 0.6) edge[black!20!white, line width = 0.3mm, dotted] (page cs: 1.0, 0.6);
    \draw (page cs: 0.0, 0.7) edge[black!20!white, line width = 0.3mm, dotted] (page cs: 1.0, 0.7);
    \draw (page cs: 0.0, 0.8) edge[black!20!white, line width = 0.3mm, dotted] (page cs: 1.0, 0.8);
    \draw (page cs: 0.0, 0.9) edge[black!20!white, line width = 0.3mm, dotted] (page cs: 1.0, 0.9);
  \end{tikzpicture}  
}